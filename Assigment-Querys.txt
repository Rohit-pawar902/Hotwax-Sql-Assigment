1) List all the columns of the Salespeople table.
select * from salespeople;

2) List all customers with a rating of 100.
select * from customers where rating=100;

3)Find the largest order taken by each salesperson on each date.
select SNUM,count(*) AS LARGEST_ORDER_TAKEN from orders group by SNUM;

4). Arrange the Order table by descending customer number.
 select * from orders order by CNUM desc;

5).Find which salespeople currently have orders in the order table. 
 
 select sp.SNAME from orders AS od cross join salespeople AS sp  where od.SNUM = sp.SNUM group by od.SNUM  ;

6). List names of all customers matched with the salespeople serving them. 

 select sp.SNAME as salesPerson_Serving_to , cust.CNAME as customerName from salespeople As sp right join customers As cust on cust.SNUM = sp.SNUM ;

7). Find the names and numbers of all salespeople who have more than one customer.
 

select * from 
(select sp.SNAME,count(*) AS countCustomer  from salespeople As sp right join customers As cust on sp.SNUM=cust.SNUM  group by cust.SNUM) As NoOfCustomersOfSalesPerson
where countCustomer>1 ;

8) Count the orders of each of the salespeople and output the results in descending order.

 select sp.SNAME, count(*) As NoOfOrders from 
 orders As od Left join salespeople As sp on od.SNUM = sp.SNUM  
 group by od.SNUM order by NoOfOrders desc;

9) List the customer table if and only if one or more of the customers in the Customer table are located in SanJose.

select * from customers where city='sanjose';

10) Match salespeople to customers according to what city they live in.

select * from salespeople As sp  cross join customers As cust where sp.CITY=cust.CITY;
select * from salespeople As sp  Left join customers As cust ON sp.CITY=cust.CITY Where cust.CNUM is not null ;

11) Find all the customers in SanJose who have a rating above 200.

select * from customers where city="sanjose" And rating > 200;


12) List the names and commissions of all salespeople in London.

 select SNAME as salespeople , COMM as commissions from salespeople where city='london';

13) List all the orders of Salesperson Motika from the orders table.

select * from orders where SNUM=(select SNUM from salespeople where SNAME='motika');

14) Find all customers who booked orders on October 3.

{% comment %} orders table sa oct 3 pa Cnum lauga then ushi ma group by karke unique Cnum, and then join and croos where cnum=custnum {% endcomment %}
 select * from 
-> customers cross join (select CNUM  from orders where ODATE='2019-08-02' group by CNUM) AS listCustomer
-> Where listCustomer.CNUM=customers.CNUM;

15) Give the sums of the amounts from the Orders table, grouped by date, eliminating all those dates where the SUM was not at least 2000 above
the maximum Amount.

{% comment %} 2000> WALA HI CHAHIYA SIMPLIe as of now i think maxAmount is in gp of date /if not then i just make a sub Query to ge max amount Amt{% endcomment %}
 SELECT ODATE,sum(AMT) from orders GROUP BY ODATE having sum(AMT)>max(Amt)+2000 ;

 SELECT ODATE,sum(AMT) from orders GROUP BY ODATE having sum(AMT)>2000+(select max(AMT) from orders) ;

16) Select all orders that had amounts that were greater than at least one of the orders from October 6.

select * from orders where AMT >(select min(AMT) from orders where ODATE='2019-08-02' ) where ODATE<>'2019-08-02';

select * from orders cross join (select AMT from orders where ODATE='2019-08-02' ) AS data  where orders.AMT> data.AMT and orders.ODATE<>'2019-08-02' ;

17) Write a query that uses the EXISTS operator to extract all salespeople who have customers with a rating of 300.

select SNAME from salespeople where EXISTS (select rating from customers where Rating=300 );

18) Find all customers whose cnum is 1000 above the snum of Serres.
{% comment %} 1000> above and salesPerson 'Serees' {% endcomment %}
select * from customers where CNUM > (Select snum+1000 from salespeople where sname = 'Serres');

19) Give the salespeople’s commissions as percentages instead of decimal numbers.
{% comment %} DOUBT {% endcomment %}
select SNAME,COMM,COMM*100 as Percentage from salespeople;

20) Find the largest order taken by each salesperson on each date, eliminating those Maximum orders, which are less than 3000.

select sp.SNAME,od.AMT,od.ODate from salespeople as sp,orders AS od WHERE sp.SNUM = od.SNUM AND od.AMT > 1000 group by ODATE;

21) List all the largest orders for October 3, for each salesperson.

select sp.SNAME,max(od.AMT) As Largest_Order_Amount ,od.ODate from salespeople as sp,orders AS od WHERE sp.SNUM = od.SNUM AND ODATE ='2019-10-02' group by sp.SNUM;

22) Find all customers located in cities where Serres has customers.
//finding all customes which has same city as of serres customers have

select * from customers AS cust right join (select city,SNUM As salesp CNAME from customers where SNUM=(select SNUM from salespeople where SNAME="serres" )) As AllCutomersCity as acc ON cust.city=acc.city AND cust.SNUM<>acc.salesp ;
 
select cust.CName,cust.city from customers AS cust right join (select city,SNUM As salesp from customers where SNUM=(select SNUM from salespeople where SNAME="serres" )) As acc ON cust.city=acc.city AND cust.SNUM<>acc.salesp AND cust.CNUM is not NULL ;

23) Select all customers with a rating above 200.

Select * from customer where Rating >200

24) Count the number of salespeople currently having orders in the orders table.

select count(distinct Snum) as no_of_salespeople 
from orders ;


25) Write a query that produces all customers serviced by salespeople with a commission above 12%. Output the customer’s name,
salesperson’s name and the salesperson’s rate of commission.


26) Find salespeople who have multiple customers.
 select sp.SNAME 
 from salespeople as sp 
 left join customers as cust on sp.SNUM=cust.SNUM
 group by cust.SNUM
 having count(cust.SNUM)>1;

27) Find salespeople with customers located in their own cities.
 select sp.SNAME,cust.CNAME,cust.CITY 
 from salespeople as sp 
 Inner join customers as cust on sp.CITY=cust.CITY 
 order by cust.CITY; 
28) Find all salespeople whose name starts with ‘P’ and fourth character is ‘I’.

select * from salespeople where SNAME like 'p__i%'

29) Write a query that uses a subquery to obtain all orders for the customer named ‘Cisneros’. Assume you do not know his customer number.

select ord.* from orders as ord where CNUM =(select CNUM from customers where CNAME="Cisneros");

30) Find the largest orders for Serres and Rifkin.

select * from orders where AMT in (select max(AMT) from orders where SNUM in (select SNUM from salespeople where SNAME="Rifkin" or SNAME="Serres" ) group by SNUM)
